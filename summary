In this project, we want to justify whether the Generic Substitute (GS) and Restriction Index (RI) are efficient in controlling drugs costs. We analyzed collected data of “COST” (response) and related seven potential explanatory variables (including GS and RI) with several quantitative steps with different methods. And we drew a conclusion that ….

The histograms of all variables show skewness in GS, RI, COPAY and MM. Since in regression, all the independent variables need to be normally distributed, we use best Box-Cox transformation for each independent variable, and transform response variable accordingly. We will use GS^2, sqrt(RI), log(COPAY), and sqrt(MM) in our analysis. All other variables will stay the same. 

The scatter plots of each predictor versus COST have no apparent curvature so that we can predict COST using linear model. We fit a linear model of COST on all independent variables and check conditions. The regression function is:
  COST=beta0+beta1*RXPM+beta2*GS^2+beta3*sqrt(RI)+…….懒得写了
Residuals are homoscedasticity. Predicted values are normally distributed. Although there exist several outliers, all cook’s distances are less than 0.5 showing that there is no influential observation. Thus, there is no need to remove any single observations.

Then we test for possible polynomials and interactions in the regression. Using GAM, we find that sqrt(RI), its second power (RI) are significant in predicting COST. Thus, we also consider these two variables into our model. However, because of the collinearity between sqrt(RI) and RI (correlation=0.969), we use the deviation between the variable and its mean instead, i.e. RInew=sqrt(RI)-mean(sqrt(RI)), RI2new=(RInew)2. The polynomial is still significant in the linear model and correlation between sqrt(RI) and RI reduces to 0.192. We haven’t found any significant interaction terms. Now, the full model becomes
	COST=xxxxxxxxxxxxxxx
	Using some algebra, we know that the coefficient on RI is beta8, and coefficient on sqrt(RI) is beta3- beta8*mean(sqrt(RI)). There is no apparent pattern in residual plot. The predicted values are roughly normally distributed. There exists no influential point as all cook’s distances are less than 0.5. We also check for multicollinearity, and conclude there are no multicollineared predictors.

Use our new data set, we test for the effect of GS and RI on COST using several different ways. The results from all methods agree that GS and RI have a negative effect on COST. 
(1)	Stepwise Selection & Best Subsets
Forward selection, backward selection, and best subsets method yield the same best model: COST is depended on RXPM, GS, and RInew2. Since the quadratic term RInew2 is included, we also need to include RInew in the model. The model using these method is 
COST=1.328+0.0231*RXPM-1.85*10^(-4)*GS^2-0.0126*RInew+1.644*RInew2
After some algebraic steps, the model becomes
COST=1.4990.0231*RXPM-0.0136*GS-0.0732*sqrt(RI)+1.644*RI
Holding other variables the same, we make a plot of how COST change with different values of RI. We can see that at the COST first decreases and then increases as RI increase, and RI=5 the sign of first derivative of the curve changes. The maximum value of RI such that RI has a negative effect on COST is when RI=19.

(2)	LASSO regression
We also use LASSO to fit the model. LASSO selects 6 variables as significant predictors of COST. The best LASSO model is 
COST=1.610 + 0.0185*RXPM – 1.678*10^(-4) GS^2 – 4.40010^(-3) RInew – 9.383 *AGE + 2.870 * sqrt(MM) + 0.0135 RInew2

This is equivalent to 
COST=1.772 + 0.0185*RXPM – 0.0130 GS – 0.0534 sqrt(RI) – 9.383 *AGE + 2.870 * sqrt(MM) + 0.0135 RI

GS has negative coefficient in LASSO regression meaning that control for other parameters, GS has negative effect on COST. The plot for COST change at different values of RI follows the same trend as in linear model case, with maximum value of RI that has negative effect on COST being 15, and when RI=4 we obtain minimum COST holding other variables the same.


